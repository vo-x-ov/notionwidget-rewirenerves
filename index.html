<!DOCTYPE html>
<html lang="en">
head>
  <meta charset="UTF-8" />
  <title>Rewire Nerves</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="rn-widget-container" id="rnWidget">

    <!-- HEADER -->
    <header class="rn-header">
      <div class="rn-title-block">
        <div class="rn-icon">üß†‚ú®</div>
        <div>
          <h1>Rewire Nerves</h1>
          <p class="rn-subtitle">Shift your state with intentional protocols.</p>
        </div>
      </div>

      <div class="rn-top-controls">
        <div class="rn-select-group">
          <label for="rnTypeSelect">Domain</label>
          <select id="rnTypeSelect"></select>
        </div>

        <div class="rn-select-group">
          <label for="rnProtocolSelect">Protocol</label>
          <select id="rnProtocolSelect"></select>
        </div>

        <div class="rn-top-buttons">
          <button id="rnMarkCompleteBtn" class="btn small">Mark as complete</button>
          <button id="rnRandomProtocolBtn" class="btn small secondary">Random protocol</button>
          <button id="rnSettingsToggle" class="btn small settings" aria-expanded="false" title="Open settings">
            ‚öôÔ∏è
          </button>
        </div>
      </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="rn-body">
      <!-- Micro mantra -->
      <div id="rnMicroMantra" class="rn-micro-mantra"></div>

      <!-- Protocol card -->
      <section class="rn-protocol-card">
        <header class="rn-protocol-header">
          <div>
            <h2 id="rnProtocolTitle" class="rn-protocol-title">Protocol title</h2>
            <p id="rnProtocolSummary" class="rn-protocol-summary"></p>
          </div>
          <button id="rnToggleBodyBtn" class="btn xsmall secondary" type="button">
            Collapse body
          </button>
        </header>

        <div id="rnProtocolBody" class="rn-protocol-body">
          <!-- Filled from JS -->
        </div>

        <footer class="rn-protocol-footer">
          <div class="rn-stat-line">
            <span id="rnCompletionCount" class="rn-stat-pill">Completed 0 times</span>
            <span id="rnLastCompleted" class="rn-stat-pill rn-stat-muted">Not completed yet</span>
          </div>
        </footer>
      </section>

      <!-- Backup reminder -->
      <div id="rnBackupReminder" class="rn-backup-reminder"></div>
    </main>

    <!-- SETTINGS PANEL -->
    <section id="rnSettingsPanel" class="rn-settings-panel">
      <!-- Display settings -->
      <div class="rn-settings-section">
        <h3>Display</h3>
        <label class="rn-toggle-row">
          <input type="checkbox" id="rnWideModeToggle" />
          <span>Wide mode</span>
        </label>
      </div>

      <!-- Types -->
      <div class="rn-settings-section">
        <h3>Domains</h3>
        <p class="rn-settings-helper">Add or archive categories like Trading, Parenting, Partner, Self.</p>
        <div class="rn-inline-add">
          <input
            id="rnNewTypeInput"
            class="rn-input"
            type="text"
            placeholder="Add a domain (e.g. Trading)"
          />
          <button id="rnAddTypeBtn" class="btn small">Add</button>
        </div>
        <div id="rnTypeManageList" class="rn-manage-list"></div>
      </div>

      <!-- Protocols -->
      <div class="rn-settings-section">
        <h3>Protocols in selected domain</h3>
        <p class="rn-settings-helper">
          Manage rituals for the currently selected domain.
        </p>

        <div class="rn-inline-add rn-protocol-add">
          <input
            id="rnNewProtocolTitle"
            class="rn-input"
            type="text"
            placeholder="Protocol title"
          />
          <input
            id="rnNewProtocolSummary"
            class="rn-input"
            type="text"
            placeholder="Short summary"
          />
        </div>
        <textarea
          id="rnNewProtocolBody"
          class="rn-input rn-textarea"
          placeholder="Full protocol steps, reflections, breaths‚Ä¶"
        ></textarea>
        <div class="rn-inline-add">
          <button id="rnAddProtocolBtn" class="btn small">Add protocol</button>
        </div>

        <div id="rnProtocolManageList" class="rn-manage-list"></div>
      </div>

      <!-- Backup & transfer -->
      <div class="rn-settings-section">
        <h3>Backup & transfer</h3>
        <p class="rn-settings-helper">
          Export your Rewire Nerves data as JSON, or import a backup.
        </p>
        <div class="rn-inline-add">
          <button id="rnExportDataBtn" class="btn small">Export data</button>
          <button id="rnImportDataBtn" class="btn small secondary">Import data</button>
        </div>
      </div>
    </section>

    <!-- TOAST -->
    <div id="rnToast" class="rn-toast"></div>
  </div>

  <!-- Magical backup modal -->
  <div id="rnBackupModal" class="backup-modal-backdrop">
    <div class="backup-modal">
      <h2 class="backup-modal-title">Rewire Nerves Backup</h2>
      <p class="backup-modal-text">
        Copy this backup JSON and store it somewhere safe (Notion page, file, etc.).
      </p>
      <textarea
        id="rnBackupModalTextarea"
        class="backup-modal-textarea"
        readonly
      ></textarea>
      <div class="backup-modal-actions">
        <button id="rnBackupModalSelectBtn" class="btn small">Select all</button>
        <button id="rnBackupModalCloseBtn" class="btn small secondary">Close</button>
      </div>
    </div>
  </div>

  <script src="script.js?v=2"></script>
</body>
</html>
